# ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á

## ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß ‚úÖ
1. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç `handleCollectCoupon` ‡πÉ‡∏´‡πâ set `expires_at`
2. Deploy webhook function ‡πÅ‡∏•‡πâ‡∏ß
3. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç API key ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå test

## ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏ï‡πà‡∏≠

### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Database (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥)

1. ‡πÄ‡∏õ‡∏¥‡∏î https://supabase.com/dashboard
2. Login ‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Project
3. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà SQL Editor
4. ‡∏£‡∏±‡∏ô query ‡∏ô‡∏µ‡πâ:

```sql
SELECT 
  uc.id,
  uc.status,
  uc.expires_at,
  uc.created_at,
  c.name
FROM user_coupons uc
JOIN campaigns c ON uc.campaign_id = c.id
WHERE uc.user_id = 'Ua636ab14081b483636896549d2026398'
ORDER BY uc.created_at DESC
LIMIT 5;
```

5. ‡∏™‡πà‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏°‡∏≤‡πÉ‡∏´‡πâ‡∏î‡∏π

### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2: ‡∏ó‡∏î‡∏™‡∏≠‡∏ö API

1. ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤ browser
2. ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå `test_wallet_api_debug.html` ‡πÉ‡∏´‡∏°‡πà
3. ‡∏Å‡∏î Ctrl + Shift + R
4. ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° Test API
5. ‡∏™‡πà‡∏á‡∏†‡∏≤‡∏û‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏°‡∏≤

### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 3: ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÉ‡∏ô LINE ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á

1. ‡πÄ‡∏õ‡∏¥‡∏î LINE Bot
2. ‡∏û‡∏¥‡∏°‡∏û‡πå "‡∏õ‡πâ‡∏≤‡∏Ç‡∏≤‡∏ß"
3. ‡∏Å‡∏î "üéÅ ‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏¢!"
4. ‡∏Å‡∏î "üëõ ‡∏î‡∏π‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤"
5. ‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà

## ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°

‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏î‡∏£‡∏±‡∏ö‡πÑ‡∏õ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏´‡∏£‡πà?
- ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡∏°‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‚Üí ‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡πÄ‡∏Å‡πà‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ expires_at (‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏´‡∏°‡πà)
- ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‚Üí ‡∏ô‡πà‡∏≤‡∏à‡∏∞‡∏°‡∏µ expires_at ‡πÅ‡∏•‡πâ‡∏ß (‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ä‡πá‡∏Ñ database)
