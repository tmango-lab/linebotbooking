<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Wallet API</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }

        button {
            background: #06c755;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 16px;
            border-radius: 8px;
            cursor: pointer;
            margin: 10px 5px;
        }

        button:hover {
            background: #05b34a;
        }

        #result {
            margin-top: 20px;
            padding: 20px;
            background: #f5f5f5;
            border-radius: 8px;
            white-space: pre-wrap;
            font-family: monospace;
        }

        .success {
            background: #d4edda;
            color: #155724;
        }

        .error {
            background: #f8d7da;
            color: #721c24;
        }
    </style>
</head>

<body>
    <h1>üß™ Test Wallet API</h1>

    <button onclick="testGetCoupons()">üì• Test Get My Coupons</button>
    <button onclick="testCollectCoupon()">üéÅ Test Collect Coupon</button>

    <div id="result">‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö API...</div>

    <script>
        const SUPABASE_URL = 'https://kyprnvazjyilthdzhqxh.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt5cHJudmF6anlpbHRoZHpocXhoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzcwOTk4MzksImV4cCI6MjA1MjY3NTgzOX0.uqTZJWTcxWnZQqJUZqDMCLwHqGdMWPJCILSQKDJOKhY';
        const USER_ID = 'Ua636ab14081b483636896549d2026398';

        async function testGetCoupons() {
            const resultDiv = document.getElementById('result');
            resultDiv.textContent = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏Å get-my-coupons API...';
            resultDiv.className = '';

            try {
                const response = await fetch(`${SUPABASE_URL}/functions/v1/get-my-coupons`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
                        'apikey': SUPABASE_ANON_KEY,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ userId: USER_ID })
                });

                const data = await response.json();

                if (response.ok) {
                    resultDiv.className = 'success';
                    resultDiv.textContent = `‚úÖ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!\n\nStatus: ${response.status}\n\nResponse:\n${JSON.stringify(data, null, 2)}`;
                } else {
                    resultDiv.className = 'error';
                    resultDiv.textContent = `‚ùå Error ${response.status}\n\n${JSON.stringify(data, null, 2)}`;
                }
            } catch (error) {
                resultDiv.className = 'error';
                resultDiv.textContent = `‚ùå Error: ${error.message}`;
            }
        }

        async function testCollectCoupon() {
            const resultDiv = document.getElementById('result');
            resultDiv.textContent = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏Å collect-coupon API...';
            resultDiv.className = '';

            try {
                const response = await fetch(`${SUPABASE_URL}/functions/v1/collect-coupon`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        userId: USER_ID,
                        campaignId: 'b75c3e67-f9e1-451a-8490-4578c854b610',
                        secretCode: '‡∏õ‡πâ‡∏≤‡∏Ç‡∏≤‡∏ß'
                    })
                });

                const data = await response.json();

                if (response.ok) {
                    resultDiv.className = 'success';
                    resultDiv.textContent = `‚úÖ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!\n\nStatus: ${response.status}\n\nResponse:\n${JSON.stringify(data, null, 2)}`;
                } else {
                    resultDiv.className = 'error';
                    resultDiv.textContent = `‚ùå Error ${response.status}\n\n${JSON.stringify(data, null, 2)}`;
                }
            } catch (error) {
                resultDiv.className = 'error';
                resultDiv.textContent = `‚ùå Error: ${error.message}`;
            }
        }
    </script>
</body>

</html>